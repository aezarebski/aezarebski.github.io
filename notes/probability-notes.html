<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-04-13 Thu 17:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>probability-aez-notes</title>
<meta name="author" content="Alexander E. Zarebski" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet.css" />
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">probability-aez-notes</h1>
<p>
<a href="../index.html">Home</a>
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgdbf6031">Probability notes</a>
<ul>
<li><a href="#org66adfc7">\(\sigma\)-field</a></li>
<li><a href="#orge40e931">Probability measure</a></li>
<li><a href="#org4973f6b">Conditional probability</a></li>
<li><a href="#orgf6eadcc">Poisson process</a></li>
<li><a href="#org26b96bb">Probability generating function (PGF)</a></li>
<li><a href="#org68c0121">Birth process</a></li>
<li><a href="#org69cfa63">Birth-death process</a></li>
<li><a href="#orgee81781">Moment closure</a></li>
<li><a href="#org2d53ee7">Change/Transformation of variable</a></li>
<li><a href="#org795e82e">Random walk</a></li>
<li><a href="#org084bc84">Geometric series</a></li>
<li><a href="#orgd049aa6">Squeeze theorem</a></li>
</ul>
</li>
<li><a href="#org2be7329">Miscellaneous</a></li>
<li><a href="#orgfdef77c">Distributions</a>
<ul>
<li><a href="#org6c23141">Dirichlet process</a></li>
<li><a href="#org93a1373">Log-normal</a></li>
<li><a href="#org5ac9ee3">Negative binomial</a></li>
<li><a href="#org5ecb532">Poisson</a></li>
<li><a href="#org27a1290">Bivariate discrete distributions</a></li>
<li><a href="#orgbaab606">Bivariate Poisson (by trivariate reduction)</a></li>
<li><a href="#org928a872">Bivariate negative binomial (by multiplicative method)</a></li>
<li><a href="#org22cce4c">Bivariate negative binomial (by generating function)</a></li>
</ul>
</li>
<li><a href="#org653fe73">Bibliography</a>
<ul>
<li><a href="#orgf270496">edwards1961class</a></li>
<li><a href="#orgf725983">famoye2010bivariate</a></li>
<li><a href="#org34ae74b">karlis2003analysis</a></li>
<li><a href="#orga336ed9">lakshminarayana1999bivariate</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgdbf6031" class="outline-2">
<h2 id="orgdbf6031">Probability notes</h2>
<div class="outline-text-2" id="text-orgdbf6031">
</div>
<div id="outline-container-org66adfc7" class="outline-3">
<h3 id="org66adfc7">\(\sigma\)-field</h3>
<div class="outline-text-3" id="text-org66adfc7">
<p>
A \(\sigma\)-field, \(\Sigma\), over a set \(\Omega\) is a subset of the power
set of \(\Omega\) (ie it is a set of subsets of \(\Omega\)) with three
properties:
</p>

<ol class="org-ol">
<li>\(\Sigma\) contains \(\Omega\),</li>
<li>\(\Sigma\) is closed under complements, and</li>
<li>\(\Sigma\) is closed under countable unions.</li>
</ol>
</div>
</div>

<div id="outline-container-orge40e931" class="outline-3">
<h3 id="orge40e931">Probability measure</h3>
<div class="outline-text-3" id="text-orge40e931">
<p>
Given a set, \(\Omega\) and a <a href="#org66adfc7">\(\sigma\)-field</a>, \(\Sigma\), over it, a real
valued function, \(\mu\) is a measure if
</p>

<ol class="org-ol">
<li>\(\mu\) is non-negative,</li>
<li>\(\mu(\emptyset) = 0\), and</li>
<li>\(\mu\) has countable additivity, ie the measure of a union of a countable
set of disjoint sets is the sum of the measures of them.</li>
</ol>

<p>
A probability measure is a measure where \(\mu(\Omega) = 1\).
</p>
</div>
</div>

<div id="outline-container-org4973f6b" class="outline-3">
<h3 id="org4973f6b">Conditional probability</h3>
<div class="outline-text-3" id="text-org4973f6b">
<p>
For a <a href="#orge40e931">probability measure</a> if \(P(B) > 0\), then the probability of \(A\) given
\(B\) is defined by
</p>

<p>
\[
P(A\mid B) = \frac{P(A \cap B)}{P(B)}
\]
</p>
</div>
</div>

<div id="outline-container-orgf6eadcc" class="outline-3">
<h3 id="orgf6eadcc">Poisson process</h3>
<div class="outline-text-3" id="text-orgf6eadcc">
<p>
This is a continuous time process which counts the arrivals which occur at
exponentially distributed times with rate \(\lambda\). The master equations for
this process are
</p>

<p>
\[
\frac{dp_0}{dt} = - \lambda p_0
\]
</p>

<p>
and for \(i>0\)
</p>

<p>
\[
\frac{dp_i}{dt} = \lambda p_{i-1} - \lambda p_{i}
\]
</p>

<p>
Note that the rate at which the population increases in independent of the size
of the population. We can multiply through by \(z^{i}\) and sum over \(i\) to
get the following PDE for the PGF, \(g(z,t)\)
</p>

<p>
\[
\frac{\partial g}{\partial t} = \lambda (z - 1) g
\]
</p>

<p>
which, considering the initial condition \(g(z,0)=1\) gives us the PGF
</p>

<p>
\[
g(z,t) = \exp\{ \lambda t (z - 1) \}
\]
</p>

<p>
which is the PGF for a Poisson distribution with rate \(\lambda t\).
</p>
</div>
</div>

<div id="outline-container-org26b96bb" class="outline-3">
<h3 id="org26b96bb">Probability generating function (PGF)</h3>
<div class="outline-text-3" id="text-org26b96bb">
<p>
For a discrete random variable \(X\) taking values from the non-negative
integers, the <i>probability generating function</i> is defined as
</p>

<p>
\[
G(z) = \mathbb{E}(z^{X}) = \sum_{x=0}^{\infty} f_X(x) z^{x}
\]
</p>

<p>
where \(f_X\) is the <i>probability mass function</i> (PMF).
</p>
</div>
</div>

<div id="outline-container-org68c0121" class="outline-3">
<h3 id="org68c0121">Birth process</h3>
<div class="outline-text-3" id="text-org68c0121">
<p>
Consider a process where individuals give birth with rate \(\lambda\). In this
case the rate at which the population increases in size depends on the current
population size. The master equation for this is
</p>

<p>
\[
\frac{dp_i}{dt} = \lambda (i - 1) p_{i-1} - \lambda i p_i
\]
</p>

<p>
for \(i\geq n\) where the process starts with a population of size \(n\):
\(p_{n}(0) = 1\). Multiplying through by \(z^i\) and summing over \(i\) gives
the following PDE for the PGF, \(g(z,t)\)
</p>

<p>
\[
\frac{\partial g}{\partial t} = \lambda (z^2 - z) \frac{\partial g}{\partial z}.
\]
</p>

<p>
Given the initial condition, the boundary condition for the PDE is \(g(z,0) =
z^n\). The method of characteristics looks suitable for solving this; the
function, \(g\), will be constant along the curves satisfying
</p>

<p>
\[
\frac{dz}{dt} = \lambda (z - z^2).
\]
</p>

<p>
(Hopefully you remember how to do partial fractions!)
This leads us to conclude that the function is constant upon curves where
</p>

<p>
\[
C = \frac{z \exp\{ -\lambda t\}}{1 - z (1 - \exp\{ -\lambda t\})}.
\]
</p>

<p>
So we know that \(g\) must be a function of the RHS of the previous equation.
With the initial condition \(n=1\) &#x2014; which due to independence is usually
sufficient to consider &#x2014; that function is the identity function so
</p>

<p>
\[
g(z,t) = \frac{z \exp\{ -\lambda t\}}{1 - z (1 - \exp\{ -\lambda t\})}.
\]
</p>

<p>
From this we can then see that
</p>

<p>
\[
\lim _{z\to 1} g_{z}(z,t) = \exp\{\lambda t\}
\]
</p>

<p>
which agrees with the mean-field approximation. To check that this is actually a
solution to the PDE, we can use the following little bit of Maxima
</p>

<div class="org-src-container">
<pre class="src src-maxima">define(g(z,t), z * exp(-l * t) / (1 - z * ( 1- exp(-l * t))));

is(equal(l * z * (z - 1) * diff(g(z,t), z), diff(g(z,t), t)));
is(equal(g(z,0), z));
</pre>
</div>
</div>
</div>

<div id="outline-container-org69cfa63" class="outline-3">
<h3 id="org69cfa63">Birth-death process</h3>
<div class="outline-text-3" id="text-org69cfa63">
<p>
Consider a process where individuals give birth at a rate \(\lambda\) and die at
a rate \(\mu\). The master equation for this is
</p>

<p>
\[
\frac{dp_i}{dt} = \lambda (i - 1) p_{i-1} - \lambda i p_{i} + \mu (i + 1) p_{i+1} - \mu i p_{i}.
\]
</p>

<p>
with the condition that \(p_i=0\) for \(i<0\). Multiplying through by \(z^i\)
and summing over \(i\) gives the following PDE for the PGF, \(g(z,t)\)
</p>

<p>
\[
\frac{\partial g}{\partial t} = (1 - z) ( \mu - \lambda z) \frac{\partial g}{\partial z}.
\]
</p>

<p>
Given the initial condition, the boundary condition for the PDE is \(g(z,0) =
z^n\). The method of characteristics looks suitable for solving this; the
function, \(g\), will be constant along the curves satisfying
</p>

<p>
\[
\frac{dz}{dt} = (1 - z) ( \mu - \lambda z).
\]
</p>

<p>
(Hopefully you remember how to do partial fractions!)
This leads us to conclude that the function is constant upon curves where
</p>

<p>
\[
C = \frac{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \mu (z-1)}{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \lambda (z-1)}.
\]
</p>

<p>
So we know that the solution can only be a function of the RHS of the previous
equation. Since this simplifies to \(z\) at \(t=0\) and assuming the initial
condition \(n=1\) we get the solution
</p>

<p>
\[
g(z,t) = \frac{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \mu (z-1)}{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \lambda (z-1)}.
\]
</p>

<p>
We can then test this in maxima with the following
</p>

<div class="org-src-container">
<pre class="src src-maxima">define(g(z,t), ((b * z - a) * exp(- (b - a) * t) - a * ( z- 1)) / ((b * z - a) * exp(- (b - a) * t) - b * ( z- 1)));

is(equal((1-z)*(b*z-a) * diff(g(z,t), z), -diff(g(z,t), t)));
is(equal(g(z,0), z));
</pre>
</div>

<p>
Taking the derivative and the limit we get that the expected population size is
\(exp\{(&lambda;-&mu;)t\} which again agrees with the mean field approximation.
</p>
</div>
</div>

<div id="outline-container-orgee81781" class="outline-3">
<h3 id="orgee81781">Moment closure</h3>
<div class="outline-text-3" id="text-orgee81781">
<p>
For notes on moment closure, see my <a href="./statistics-notes.html">statistics notes</a>.
</p>
</div>
</div>

<div id="outline-container-org2d53ee7" class="outline-3">
<h3 id="org2d53ee7">Change/Transformation of variable</h3>
<div class="outline-text-3" id="text-org2d53ee7">
<p>
This is a particularly nifty trick when dealing with tricky MCMC problems, see
my <a href="./statistics-notes.html#org9a6ede6">statistics notes</a>.
</p>
</div>
</div>

<div id="outline-container-org795e82e" class="outline-3">
<h3 id="org795e82e">Random walk</h3>
<div class="outline-text-3" id="text-org795e82e">
</div>
<div id="outline-container-orgd74843c" class="outline-4">
<h4 id="orgd74843c">Polya's Random Walk Theorem</h4>
<div class="outline-text-4" id="text-orgd74843c">
<blockquote>
<p>
<b>Theorem</b> The simple random walk on \(\mathbb{Z}^{d}\) is recurrent in
 dimensions \(d=1,2\) and transient in dimensions \(d\geq 3\).
</p>
</blockquote>

<p>
Jonathon Novak has a particularly clear <a href="https://doi.org/10.4169/amer.math.monthly.121.08.711">proof</a> of this result.
</p>
</div>
</div>
</div>

<div id="outline-container-org084bc84" class="outline-3">
<h3 id="org084bc84">Geometric series</h3>
<div class="outline-text-3" id="text-org084bc84">
<p>
\[
\sum_{k=0}^{\infty} r^{k} = \frac{1}{1 - r}
\]
</p>

<p>
for \(|r| < 1\).
</p>
</div>
</div>

<div id="outline-container-orgd049aa6" class="outline-3">
<h3 id="orgd049aa6">Squeeze theorem</h3>
<div class="outline-text-3" id="text-orgd049aa6">
<p>
Let \(\{a_n\}\) and \(\{c_n\}\) be two sequences which converge to \(l\). If
there is an \(N\) such that for all \(n\geq N\) we have \(a_n \leq b_n \leq
c_n\), then \(\{b_n\}\) also converges to \(l\).
</p>
</div>
</div>
</div>

<div id="outline-container-org2be7329" class="outline-2">
<h2 id="org2be7329">Miscellaneous</h2>
<div class="outline-text-2" id="text-org2be7329">
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Secretary_problem">Secretary problem</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgfdef77c" class="outline-2">
<h2 id="orgfdef77c">Distributions</h2>
<div class="outline-text-2" id="text-orgfdef77c">
</div>
<div id="outline-container-org6c23141" class="outline-3">
<h3 id="org6c23141">Dirichlet process</h3>
<div class="outline-text-3" id="text-org6c23141">
<ul class="org-ul">
<li>The Dirichlet <i>process</i> is not from the Dirichlet <i>distribution</i>.</li>
<li>There are three main ways to think about the DP:
<ul class="org-ul">
<li>the Chinese restraunt process,</li>
<li>the stick-breaking process,</li>
<li>and the Polya urn scheme</li>
</ul></li>
<li>The DP has "rich-get-richer" behaviour.</li>
<li>The DP is defined by a <i>base distribution</i>, \(H\), and a <i>scaling parameter</i>, \(\alpha\).
<ul class="org-ul">
<li>For larger values of \(\alpha\) the distribution looks more like \(H\), for
smaller values it looks like a resampled sample from \(H\) where previously
sampled values become more likely to be resampled.</li>
</ul></li>
<li>This has found substantial use in Bayesian nonparameteric inference where it
is used as a prior.</li>
</ul>
</div>
</div>

<div id="outline-container-org93a1373" class="outline-3">
<h3 id="org93a1373">Log-normal</h3>
<div class="outline-text-3" id="text-org93a1373">
</div>
<div id="outline-container-orgf5ef3e0" class="outline-4">
<h4 id="orgf5ef3e0">Notation</h4>
<div class="outline-text-4" id="text-orgf5ef3e0">
<p>
\[
X \sim \text{Lognormal}(\mu,\sigma^2)
\]
</p>

<p>
where \(\mu\) can be any real number and \(\sigma>0\).
</p>
</div>
</div>

<div id="outline-container-org24a6091" class="outline-4">
<h4 id="org24a6091">Properties</h4>
<div class="outline-text-4" id="text-org24a6091">
</div>
<ul class="org-ul">
<li><a id="orga1457fc"></a>Density<br />
<div class="outline-text-5" id="text-orga1457fc">
<p>
\[
f(x) = \frac{1}{x \sigma \sqrt{2 \pi}} \exp\left\{ - \frac{{(\log(x) - \mu)}^{2}}{2\sigma^{2}} \right\}
\]
</p>

<p>
If \(g(x)\) is the density of \(N(\mu, \sigma)\), then
</p>

<p>
\[
f(x) = g(\log x) / x.
\]
</p>

<div class="org-src-container">
<pre class="src src-maxima">load(distrib);

print(is(equal(pdf_lognormal(x, m, s), unit_step(x) * pdf_normal(log(x), m, s) / x)));
</pre>
</div>

<p>
which outputs the message
</p>

<pre class="example" id="org91ac7e0">
: true
</pre>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5ac9ee3" class="outline-3">
<h3 id="org5ac9ee3">Negative binomial</h3>
<div class="outline-text-3" id="text-org5ac9ee3">
</div>
<div id="outline-container-org835eda3" class="outline-4">
<h4 id="org835eda3">Notation</h4>
<div class="outline-text-4" id="text-org835eda3">
<p>
\[
X \sim \text{NB}(r,p)
\]
</p>

<p>
where \(r>0\) and \(p\in[0,1]\).
</p>
</div>
</div>

<div id="outline-container-orgc04dc67" class="outline-4">
<h4 id="orgc04dc67">Properties</h4>
<div class="outline-text-4" id="text-orgc04dc67">
<p>
<b>Note</b> that sometimes the distribution is parameterised in terms of \(1-p\)
which will change the following expressions.
</p>
</div>

<ul class="org-ul">
<li><a id="orgf8e9b43"></a>Mean and variance<br />
<div class="outline-text-5" id="text-orgf8e9b43">
<p>
\[
\mathbb{E}X = \frac{pr}{1-p}
\]
</p>

<p>
\[
\mathbb{V}X = \frac{pr}{(1-p)^2}
\]
</p>

<p>
and so
</p>

<p>
\[
p = 1 - \frac{m}{v}, \quad r = \frac{m^2}{v - m}
\]
</p>
</div>
</li>

<li><a id="orge536eee"></a>Probability generating function<br />
<div class="outline-text-5" id="text-orge536eee">
<p>
\[
G(z, r, p) = \left(\frac{1-p}{1-pz}\right)^r
\]
</p>

<p>
which has some useful properties:
</p>

<ul class="org-ul">
<li>\(G(\alpha z, r, p) = \left(\frac{1 - p}{1 - pz}\right)^r G(z, r, \alpha p)\)</li>
<li>\(\partial_{z}^{n} G(z, r, p) = r^{\bar{n}} \left( \frac{p}{1-p} \right)^{n}
  G(z, r + n, p)\) where \(x^{\bar{n}} = x (x + 1) \dots (x + n - 1)\) (ie the
Pochhammer symbol<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>).</li>
<li>\(z G(z, r, p) = G(z, r, p) / p - (1 - p) G(z, r - 1, p) / p\)</li>
</ul>

<p>
There is a maxima script for showing this is true <a href="./neg-binom.mac">here</a>.
</p>
</div>
</li>

<li><a id="org135b058"></a>Moment generating function<br />
<div class="outline-text-5" id="text-org135b058">
<p>
\[
M_{X}(t) = \left(\frac{1-p}{1-p e^{t}}\right)^r
\]
</p>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5ecb532" class="outline-3">
<h3 id="org5ecb532">Poisson</h3>
<div class="outline-text-3" id="text-org5ecb532">
</div>
<div id="outline-container-org2e83167" class="outline-4">
<h4 id="org2e83167">Notation</h4>
<div class="outline-text-4" id="text-org2e83167">
<p>
\[
X \sim \text{Pois}(\lambda\)
\]
</p>

<p>
where \(\lambda > 0\).
</p>
</div>
</div>

<div id="outline-container-org8a1d163" class="outline-4">
<h4 id="org8a1d163">Properties</h4>
<div class="outline-text-4" id="text-org8a1d163">
<p>
\[
\mathbb{E}X = \lambda
\]
</p>

<p>
\[
\mathbb{V}X = \lambda
\]
</p>

<p>
The moment generating function is
</p>

<p>
\[
G_{x}(z) = \exp[ \lambda (e^z - 1) ]
\]
</p>
</div>
</div>
</div>

<div id="outline-container-org27a1290" class="outline-3">
<h3 id="org27a1290">Bivariate discrete distributions</h3>
<div class="outline-text-3" id="text-org27a1290">
</div>
<div id="outline-container-org5a2b734" class="outline-4">
<h4 id="org5a2b734">Trivariate reduction</h4>
<div class="outline-text-4" id="text-org5a2b734">
<p>
Suppose that \(X = X_1 + X_3\) and \(Y = X_2 + X_3\) have the desired marginal
distributions where the \(X_i\) are independent. This method of constructing
bivariate distributions is called <i>trivariate reduction</i>. For example, a
bivariate Poisson distribution can be constructed in this way.
</p>
</div>
</div>

<div id="outline-container-org4a3befa" class="outline-4">
<h4 id="org4a3befa">Multiplicative method</h4>
<div class="outline-text-4" id="text-org4a3befa">
<p>
For marginal PMFs \(f_X\) and \(f_Y\) the multiplicative method produces a
bivariate distribution with PMF
</p>

<p>
\[
f_X(x)f_Y(y)(1 + \lambda (g_1(x) - c_1) (g_2(y) - c_2))
\]
</p>

<p>
where the \(g_i\) are functions that are bounded and \(c_1 = \mathbb{E}g_1(X)\)
and \(c_2 = \mathbb{E}g_2(Y)\), with the expectations taken over the given
marginal. This construction allows for both positive and negative correlations
but limitations on \(\lambda\) can bound the strength of the correlation. See
<a href="#orga336ed9">Lakshminarayana <i>et al</i> (1999)</a> for an example using a Poisson distribution and
<a href="#orgf725983">Famoye (2010)</a> for a bivariate negative binomial distribution
</p>
</div>
</div>
</div>

<div id="outline-container-orgbaab606" class="outline-3">
<h3 id="orgbaab606">Bivariate Poisson (by trivariate reduction)</h3>
<div class="outline-text-3" id="text-orgbaab606">
<p>
This distribution is constrained to have a non-negative correlation. See <a href="#org34ae74b">Karlis
and Ntzoufras (2003)</a> for an example.
</p>
</div>

<div id="outline-container-org6ebdee8" class="outline-4">
<h4 id="org6ebdee8">Notation</h4>
<div class="outline-text-4" id="text-org6ebdee8">
<p>
\[
(X,Y) \sim \text{BP}(\lambda_{1},\lambda_{2},\lambda_{3})
\]
</p>

<p>
when \(X = X_{1} + X_{3}\) and \(Y = X_{2} + X_{3}\), and the \(X_{i} \sim
\text{Pois}(\lambda_{i})\) (independently).
</p>
</div>
</div>
</div>

<div id="outline-container-org928a872" class="outline-3">
<h3 id="org928a872">Bivariate negative binomial (by multiplicative method)</h3>
<div class="outline-text-3" id="text-org928a872">
<p>
See <a href="#orgf725983">Famoye (2010)</a> for a bivariate negative binomial distribution constructed
using the <a href="#org4a3befa">multiplicative method</a> described above.
</p>
</div>
</div>

<div id="outline-container-org22cce4c" class="outline-3">
<h3 id="org22cce4c">Bivariate negative binomial (by generating function)</h3>
<div class="outline-text-3" id="text-org22cce4c">
<p>
This distribution comes from <a href="#orgf270496">Edwards and Gurland (1961)</a>, who call it the
<i>compound correlated bivariate Poisson distribution</i>. The PGF of this distribution is
</p>

<p>
\[
g_{X_1, X_2}(z_1, z_2) = \left( A + B_1 z_1 +B_2 z_2 + B_{12} z_1 z_2 \right)^{-k}
\]
</p>

<p>
where \(A = 1 - B_1 - B_2 - B_{12}\). The PGF can then be used to get the PGFs
of the marginal distributions and from this we can get the MGF and hence the
moments.
</p>

<p>
Although Edwards and Gurland (1961) provide expressions for the PMF, they
suggest that the recurrence relations that they provide can provide a
computationally more convenient approach.
</p>
</div>

<div id="outline-container-org9e5d0d2" class="outline-4">
<h4 id="org9e5d0d2">Method of moments parameters</h4>
<div class="outline-text-4" id="text-org9e5d0d2">
<p>
The following snippets demonstrate how to compute the method of moments
estimators given the first two moments of the first marginal and the covariance
and the mean of the second marginal. We can define the PGF in maxima and then
compute the mean and variance of the marginal distributions and check that these
match up with the values given by Edwards and Gurland (1961).
</p>

<div class="org-src-container">
<pre class="src src-maxima">g(z1, z2) := ((1 - B1 - B2 - B12) + B1 * z1 + B2 * z2 + B12 * z1 * z2) ^ (-k);

m1(t) := ratsimp(g(exp(t), 1));

m11 : subst(0, t, diff(m1(t), t, 1));
m12 : subst(0, t, diff(m1(t), t, 2));

var1 : collectterms(expand(m12 - m11^2), k);

/* check that the variance is correct */
display(is(equal(var1, -k * (B1 + B12) * (1 - B1 - B12))));
</pre>
</div>

<p>
which outputs the message
</p>

<pre class="example" id="org4488421">
:             is(equal(var1, (- k) (B1 + B12) (1 - B1 - B12))) = true
</pre>

<p>
It is useful to define \(c = B_1 + B_{12}\). Then we can solve for \(k\) and
\(c\) based on the mean and variance of the first marginal distribution.
</p>

<div class="org-src-container">
<pre class="src src-maxima">/* use c = B1 + B12 and solve for c and k based on the marginal distribution */
display(solve([ex1 = -k * c, vx1 = ex1 * (1 - c)], [k, c])[1]);
</pre>
</div>

<p>
which outputs the message
</p>

<pre class="example" id="org89ba903">
: solve([ex1 = - c k, vx1 = (1 - c) ex1], [k, c])(1) =
:                                                          2
:                                                       ex1            vx1 - ex1
:                                                [k = ---------, c = - ---------]
:                                                     vx1 - ex1           ex1
</pre>

<p>
The next step is to check that the expression given for the covariance is
correct (and get an equivalent expression in terms of \(c\)).
</p>

<div class="org-src-container">
<pre class="src src-maxima">g(z1, z2) := ((1 - B1 - B2 - B12) + B1 * z1 + B2 * z2 + B12 * z1 * z2) ^ (-k);
m1(t) := ratsimp(g(exp(t), 1));
m11 : subst(0, t, diff(m1(t), t, 1));

m2(t) := ratsimp(g(1, exp(t)));
m21 : subst(0, t, diff(m2(t), t));
eXY : subst(0, t2, subst(0, t1, diff(diff(g(exp(t1), exp(t2)), t1), t2)));

/* check the covariance is correct */
cov_in_c : k * ((c - B1) * (c + B2 - 1) + B1 * B2);
display(is(
    equal(
      eXY - m11 * m21,
      subst(B1 + B12, c, cov_in_c)
      )
    ));
</pre>
</div>

<p>
which outputs the message
</p>

<pre class="example" id="org017e4a5">
:          is(equal(eXY - m11 m21, subst(B1 + B12, c, cov_in_c))) = true
</pre>

<p>
Finally, we can use the covariance and the mean of the second marginal
distribution to solve for \(B_1\) and \(B_2\), which then then gives us
\(B_{12}\) from the solution for \(c\).
</p>

<div class="org-src-container">
<pre class="src src-maxima">g(z1, z2) := ((1 - B1 - B2 - B12) + B1 * z1 + B2 * z2 + B12 * z1 * z2) ^ (-k);
m1(t) := ratsimp(g(exp(t), 1));
m11 : subst(0, t, diff(m1(t), t, 1));

m2(t) := ratsimp(g(1, exp(t)));
m21 : subst(0, t, diff(m2(t), t));
eXY : subst(0, t2, subst(0, t1, diff(diff(g(exp(t1), exp(t2)), t1), t2)));

/* check the covariance is correct */
cov_in_c : k * ((c - B1) * (c + B2 - 1) + B1 * B2);

/* solve for B1 and B2 based on the covariance and mean of the second marginal */
display(solve([ex2 = subst(c - B1, B12, m21), cov12 = cov_in_c], [B1, B2])[1]);
</pre>
</div>

<p>
which outputs the message
</p>

<pre class="example" id="orgc38f3d1">
: solve([ex2 = - (c + B2 - B1) k, cov12 = ((c - B1) (c + B2 - 1) + B1 B2) k],
:                                  c k + c ex2 + cov12       (c - 1) ex2 + cov12
:             [B1, B2])(1) = [B1 = -------------------, B2 = -------------------]
:                                           k                         k
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org653fe73" class="outline-2">
<h2 id="org653fe73">Bibliography</h2>
<div class="outline-text-2" id="text-org653fe73">
</div>
<div id="outline-container-orgf270496" class="outline-3">
<h3 id="orgf270496">edwards1961class</h3>
<div class="outline-text-3" id="text-orgf270496">
<div class="org-src-container">
<pre class="src src-bibtex">@article{edwards1961class,
  author =       {Carol B. Edwards and John Gurland},
  title =        {{A} {C}lass of {D}istributions {A}pplicable to {A}ccidents},
  journal =      {Journal of the American Statistical Association},
  volume =       56,
  number =       295,
  pages =        {503-517},
  year =         1961,
  publisher =    {Taylor &amp; Francis},
  doi =          {10.1080/01621459.1961.10480641},
  url =          {
                  https://amstat.tandfonline.com/doi/abs/10.1080/01621459.1961.10480641
                  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf725983" class="outline-3">
<h3 id="orgf725983">famoye2010bivariate</h3>
<div class="outline-text-3" id="text-orgf725983">
<div class="org-src-container">
<pre class="src src-bibtex">@article{famoye2010bivariate,
  journal =      {Journal of Applied Statistics},
  pages =        {969--981},
  volume =       37,
  publisher =    {Taylor &amp; Francis},
  number =       6,
  year =         2010,
  title =        {On the bivariate negative binomial regression model},
  author =       {Famoye, Felix},
  url =          {http://www.tandfonline.com/doi/abs/10.1080/02664760902984618}
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org34ae74b" class="outline-3">
<h3 id="org34ae74b">karlis2003analysis</h3>
<div class="outline-text-3" id="text-org34ae74b">
<div class="org-src-container">
<pre class="src src-bibtex">@article{karlis2003analysis,
  journal =      {Journal Of The Royal Statistical Society Series D-The
                  Statistician},
  pages =        {381--393},
  volume =       52,
  publisher =    {BLACKWELL PUBL LTD},
  year =         2003,
  title =        {{A}nalysis of sports data by using bivariate {P}oisson models},
  author =       {Karlis, D and Ntzoufras, L},
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga336ed9" class="outline-3">
<h3 id="orga336ed9">lakshminarayana1999bivariate</h3>
<div class="outline-text-3" id="text-orga336ed9">
<div class="org-src-container">
<pre class="src src-bibtex">@article{lakshminarayana1999bivariate,
  journal =      {Communications in Statistics - Theory and Methods},
  pages =        {267--276},
  volume =       28,
  publisher =    {Marcel Dekker, Inc},
  number =       2,
  year =         1999,
  title =        {{O}n a {B}ivariate {P}oisson {D}istribution},
  author =       {Lakshminarayana, J and Pandit, S.N.N and Srinivasa Rao, K},
  url =          {http://www.tandfonline.com/doi/abs/10.1080/03610929908832297}
}
</pre>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
See <a href="./numerics-notes.html#orgae8979d">these notes</a> for a definition of the Pochhammer symbol.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Alexander E. Zarebski</p>
<p class="date">Created: 2023-04-13 Thu 17:13</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>