<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-02-08 Mon 16:29 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>aez-notes</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Alex Zarebski" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet-dark.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">aez-notes</h1>
<p>
<a href="../index.html">Home</a>
</p>

<button type="button" onclick="setStyleSheet('../css/stylesheet.css')">Light</button>
<button type="button" onclick="setStyleSheet('../css/stylesheet-dark.css')">Dark</button>

<script>
    function setStyleSheet(url){
       var stylesheet = document.getElementById("stylesheet");
       stylesheet.setAttribute('href', url);
    }
</script>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org7f090d7">Probability notes</a>
<ul>
<li><a href="#orga653f97">Poisson process</a></li>
<li><a href="#org8014341">Birth process</a></li>
<li><a href="#org91e533f">Birth-death process</a></li>
<li><a href="#org225cc6a">Moment closure</a></li>
</ul>
</li>
<li><a href="#org4ad3c8a">Distributions</a>
<ul>
<li><a href="#orge4c6939">Negative binomial</a></li>
<li><a href="#orgfc47440">Poisson</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org7f090d7" class="outline-2">
<h2 id="org7f090d7">Probability notes</h2>
<div class="outline-text-2" id="text-org7f090d7">
</div>
<div id="outline-container-orga653f97" class="outline-3">
<h3 id="orga653f97">Poisson process</h3>
<div class="outline-text-3" id="text-orga653f97">
<p>
This is a continuous time process which counts the arrivals which occur at exponentially distributed times with rate \(\lambda\).
The master equations for this process are
</p>

<p>
\[
\frac{dp_0}{dt} = - \lambda p_0
\]
</p>

<p>
and for \(i>0\) 
</p>

<p>
\[
\frac{dp_i}{dt} = \lambda p_{i-1} - \lambda p_{i}
\]
</p>

<p>
Note that the rate at which the population increases in independent of the size of the population.
We can multiply through by \(z^{i}\) and sum over \(i\) to get the following PDE for the PGF, \(g(z,t)\)
</p>

<p>
\[
\frac{\partial g}{\partial t} = \lambda (z - 1) g
\]
</p>

<p>
which, considering the initial condition \(g(z,0)=1\) gives us the PGF
</p>

<p>
\[
g(z,t) = \exp\{ \lambda t (z - 1) \}
\]
</p>

<p>
which is the PGF for a Poisson distribution with rate \(\lambda t\).
</p>
</div>
</div>

<div id="outline-container-org8014341" class="outline-3">
<h3 id="org8014341">Birth process</h3>
<div class="outline-text-3" id="text-org8014341">
<p>
Consider a process where individuals give birth with rate \(\lambda\).
In this case the rate at which the population increases in size depends on the current population size.
The master equation for this is
</p>

<p>
\[
\frac{dp_i}{dt} = \lambda (i - 1) p_{i-1} - \lambda i p_i
\]
</p>

<p>
for \(i\geq n\) where the process starts with a population of size \(n\): \(p_{n}(0) = 1\).
Multiplying through by \(z^i\) and summing over \(i\) gives the following PDE for the PGF, \(g(z,t)\)
</p>

<p>
\[
\frac{\partial g}{\partial t} = \lambda (z^2 - z) \frac{\partial g}{\partial z}.
\]
</p>

<p>
Given the initial condition, the boundary condition for the PDE is \(g(z,0) = z^n\).
The method of characteristics looks suitable for solving this; the function, \(g\), will be constant along the curves satisfying
</p>

<p>
\[
\frac{dz}{dt} = \lambda (z - z^2).
\]
</p>

<p>
(Hopefully you remember how to do partial fractions!)
This leads us to conclude that the function is constant upon curves where
</p>

<p>
\[
C = \frac{z \exp\{ -\lambda t\}}{1 - z (1 - \exp\{ -\lambda t\})}.
\]
</p>

<p>
So we know that \(g\) must be a function of the RHS of the previous equation.
With the initial condition \(n=1\) &#x2014; which due to independence is usually sufficient to consider &#x2014; that function is the identity function so
</p>

<p>
\[
g(z,t) = \frac{z \exp\{ -\lambda t\}}{1 - z (1 - \exp\{ -\lambda t\})}.
\]
</p>

<p>
From this we can then see that 
</p>

<p>
\[
\lim _{z\to 1} g_{z}(z,t) = \exp\{\lambda t\}
\]
</p>

<p>
which agrees with the mean-field approximation.
To check that this is actually a solution to the PDE, we can use the following little bit of Maxima
</p>

<div class="org-src-container">
<pre class="src src-maxima"><span style="color: #4f97d7;">define</span>(g(z,t), z <span style="color: #4f97d7; font-weight: bold;">*</span> <span style="color: #4f97d7;">exp</span>(<span style="color: #4f97d7; font-weight: bold;">-</span>l <span style="color: #4f97d7; font-weight: bold;">*</span> t) <span style="color: #4f97d7; font-weight: bold;">/</span> (<span style="color: #a45bad;">1</span> <span style="color: #4f97d7; font-weight: bold;">-</span> z <span style="color: #4f97d7; font-weight: bold;">*</span> ( <span style="color: #a45bad;">1</span><span style="color: #4f97d7; font-weight: bold;">-</span> <span style="color: #4f97d7;">exp</span>(<span style="color: #4f97d7; font-weight: bold;">-</span>l <span style="color: #4f97d7; font-weight: bold;">*</span> t))));

<span style="color: #4f97d7;">is</span>(<span style="color: #4f97d7;">equal</span>(l <span style="color: #4f97d7; font-weight: bold;">*</span> z <span style="color: #4f97d7; font-weight: bold;">*</span> (z <span style="color: #4f97d7; font-weight: bold;">-</span> <span style="color: #a45bad;">1</span>) <span style="color: #4f97d7; font-weight: bold;">*</span> <span style="color: #4f97d7;">diff</span>(g(z,t), z), <span style="color: #4f97d7;">diff</span>(g(z,t), t)));
<span style="color: #4f97d7;">is</span>(<span style="color: #4f97d7;">equal</span>(g(z,<span style="color: #a45bad;">0</span>), z));
</pre>
</div>
</div>
</div>

<div id="outline-container-org91e533f" class="outline-3">
<h3 id="org91e533f">Birth-death process</h3>
<div class="outline-text-3" id="text-org91e533f">
<p>
Consider a process where individuals give birth at a rate \(\lambda\) and die at a rate \(\mu\).
The master equation for this is
</p>

<p>
\[
\frac{dp_i}{dt} = \lambda (i - 1) p_{i-1} - \lambda i p_{i} + \mu (i + 1) p_{i+1} - \mu i p_{i}.
\]
</p>

<p>
with the condition that \(p_i=0\) for \(i<0\).
Multiplying through by \(z^i\) and summing over \(i\) gives the following PDE for the PGF, \(g(z,t)\)
</p>

<p>
\[
\frac{\partial g}{\partial t} = (1 - z) ( \mu - \lambda z) \frac{\partial g}{\partial z}.
\]
</p>

<p>
Given the initial condition, the boundary condition for the PDE is \(g(z,0) = z^n\).
The method of characteristics looks suitable for solving this; the function, \(g\), will be constant along the curves satisfying
</p>

<p>
\[
\frac{dz}{dt} = (1 - z) ( \mu - \lambda z).
\]
</p>

<p>
(Hopefully you remember how to do partial fractions!)
This leads us to conclude that the function is constant upon curves where
</p>

<p>
\[
C = \frac{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \mu (z-1)}{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \lambda (z-1)}.
\]
</p>

<p>
So we know that the solution can only be a function of the RHS of the previous equation.
Since this simplifies to \(z\) at \(t=0\) and assuming the initial condition \(n=1\) we get the solution
</p>

<p>
\[
g(z,t) = \frac{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \mu (z-1)}{(\lambda z - \mu) \exp\{ - (\lambda - \mu) t \} - \lambda (z-1)}.
\]
</p>

<p>
We can then test this in maxima with the following
</p>

<div class="org-src-container">
<pre class="src src-maxima"><span style="color: #4f97d7;">define</span>(g(z,t), ((b <span style="color: #4f97d7; font-weight: bold;">*</span> z <span style="color: #4f97d7; font-weight: bold;">-</span> a) <span style="color: #4f97d7; font-weight: bold;">*</span> <span style="color: #4f97d7;">exp</span>(<span style="color: #4f97d7; font-weight: bold;">-</span> (b <span style="color: #4f97d7; font-weight: bold;">-</span> a) <span style="color: #4f97d7; font-weight: bold;">*</span> t) <span style="color: #4f97d7; font-weight: bold;">-</span> a <span style="color: #4f97d7; font-weight: bold;">*</span> ( z<span style="color: #4f97d7; font-weight: bold;">-</span> <span style="color: #a45bad;">1</span>)) <span style="color: #4f97d7; font-weight: bold;">/</span> ((b <span style="color: #4f97d7; font-weight: bold;">*</span> z <span style="color: #4f97d7; font-weight: bold;">-</span> a) <span style="color: #4f97d7; font-weight: bold;">*</span> <span style="color: #4f97d7;">exp</span>(<span style="color: #4f97d7; font-weight: bold;">-</span> (b <span style="color: #4f97d7; font-weight: bold;">-</span> a) <span style="color: #4f97d7; font-weight: bold;">*</span> t) <span style="color: #4f97d7; font-weight: bold;">-</span> b <span style="color: #4f97d7; font-weight: bold;">*</span> ( z<span style="color: #4f97d7; font-weight: bold;">-</span> <span style="color: #a45bad;">1</span>)));

<span style="color: #4f97d7;">is</span>(<span style="color: #4f97d7;">equal</span>((<span style="color: #a45bad;">1</span><span style="color: #4f97d7; font-weight: bold;">-</span>z)<span style="color: #4f97d7; font-weight: bold;">*</span>(b<span style="color: #4f97d7; font-weight: bold;">*</span>z<span style="color: #4f97d7; font-weight: bold;">-</span>a) <span style="color: #4f97d7; font-weight: bold;">*</span> <span style="color: #4f97d7;">diff</span>(g(z,t), z), <span style="color: #4f97d7; font-weight: bold;">-</span><span style="color: #4f97d7;">diff</span>(g(z,t), t)));
<span style="color: #4f97d7;">is</span>(<span style="color: #4f97d7;">equal</span>(g(z,<span style="color: #a45bad;">0</span>), z));
</pre>
</div>

<p>
Taking the derivative and the limit we get that the expected population size is \(exp\{(&lambda;-&mu;)t\} which again agrees with the mean field approximation.
</p>
</div>
</div>

<div id="outline-container-org225cc6a" class="outline-3">
<h3 id="org225cc6a">Moment closure</h3>
<div class="outline-text-3" id="text-org225cc6a">
<p>
For notes on moment closure, see my <a href="./statistics-notes.html">statistics notes</a>.
</p>
</div>
</div>
</div>

<div id="outline-container-org4ad3c8a" class="outline-2">
<h2 id="org4ad3c8a">Distributions</h2>
<div class="outline-text-2" id="text-org4ad3c8a">
</div>
<div id="outline-container-orge4c6939" class="outline-3">
<h3 id="orge4c6939">Negative binomial</h3>
<div class="outline-text-3" id="text-orge4c6939">
</div>
<div id="outline-container-org890240b" class="outline-4">
<h4 id="org890240b">Notation</h4>
<div class="outline-text-4" id="text-org890240b">
<p>
\[
X \sim \text{NB}(r,p)
\]
</p>

<p>
where \(r>0\) and \(p\in[0,1]\).
</p>
</div>
</div>

<div id="outline-container-org544ef2b" class="outline-4">
<h4 id="org544ef2b">Properties</h4>
<div class="outline-text-4" id="text-org544ef2b">
<p>
\[
\mathbb{E}X = \frac{pr}{1-p}
\]
</p>

<p>
\[
\mathbb{V}X = \frac{pr}{(1-p)^2}
\]
</p>

<p>
and so
</p>

<p>
\[
p = 1 - \frac{m}{v}, \quad r = \frac{m^2}{v - m}
\]
</p>

<p>
The moment generating function is
</p>

<p>
\[
G_{X}(z) = \left(\frac{1-p}{1-pz}\right)^r
\]
</p>
</div>
</div>

<div id="outline-container-org58a7b02" class="outline-4">
<h4 id="org58a7b02">Computation</h4>
<div class="outline-text-4" id="text-org58a7b02">
<p>
R uses a slightly different parameterisation of the negative binomial
distribution, it uses \(1-p\) where above we use \(p\).
</p>
</div>
</div>
</div>

<div id="outline-container-orgfc47440" class="outline-3">
<h3 id="orgfc47440">Poisson</h3>
<div class="outline-text-3" id="text-orgfc47440">
</div>
<div id="outline-container-orgd171abd" class="outline-4">
<h4 id="orgd171abd">Notation</h4>
<div class="outline-text-4" id="text-orgd171abd">
<p>
\[
X \sim \text{Pois}(\lambda\)
\]
</p>

<p>
where \(\lambda > 0\).
</p>
</div>
</div>

<div id="outline-container-org4e481ae" class="outline-4">
<h4 id="org4e481ae">Properties</h4>
<div class="outline-text-4" id="text-org4e481ae">
<p>
\[
\mathbb{E}X = \lambda
\]
</p>

<p>
\[
\mathbb{V}X = \lambda
\]
</p>

<p>
The moment generating function is
</p>

<p>
\[
G_{x}(z) = \exp[ \lambda (e^z - 1) ]
\]
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alex Zarebski</p>
<p class="date">Created: 2021-02-08 Mon 16:29</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
