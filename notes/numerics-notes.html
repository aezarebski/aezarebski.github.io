<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-04-17 Sun 14:21 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>aez-notes</title>
<meta name="author" content="Alex Zarebski" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet-dark.css" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">aez-notes</h1>
<p>
<a href="../index.html">Home</a>
</p>

<button type="button" onclick="toggleStyle()">Light/Dark</button>
<script src="./main.js"></script>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org1159b0d">Numerics notes</a>
<ul>
<li><a href="#org16bf034">Numbers</a></li>
<li><a href="#org4a4353a">Numeric differentiation</a></li>
<li><a href="#org5d00e08">Mathematical optimisation</a></li>
<li><a href="#orgb9f47f4">LogSumExp function</a></li>
<li><a href="#org0c8da8e">Combinatoric functions</a></li>
<li><a href="#orgc5c464d">Factorial</a></li>
<li><a href="#org286033b">Pochhammer</a></li>
<li><a href="#orga6f9c60">Computational complexity</a></li>
<li><a href="#org6ab6d76">Caching results</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1159b0d" class="outline-2">
<h2 id="org1159b0d">Numerics notes</h2>
<div class="outline-text-2" id="text-org1159b0d">
</div>
<div id="outline-container-org16bf034" class="outline-3">
<h3 id="org16bf034">Numbers</h3>
<div class="outline-text-3" id="text-org16bf034">
<p>
IEEE-754 compliant double precision numbers have a precision of about 16 decimal
places.
</p>
</div>
</div>

<div id="outline-container-org4a4353a" class="outline-3">
<h3 id="org4a4353a">Numeric differentiation</h3>
<div class="outline-text-3" id="text-org4a4353a">
<p>
The following functions use a five-point stencil to compute first and second
derivatives and have an error of order \(h^4\)
</p>

<div class="org-src-container">
<pre class="src src-haskell">firstDerivative :: Floating a =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a
firstDerivative h f x =
  (-f (x + 2 * h) + 8 * f (x + h) - 8 * f (x - h) + f (x - 2 * h)) / (12 * h)

secondDerivative :: Floating a =&gt; a -&gt; (a -&gt; a) -&gt; a -&gt; a
secondDerivative h f x =
  (-f (x + 2 * h) + 16 * f (x + h) - 30 * f x + 16 * f (x - h) - f (x - 2 * h)) / (12 * h ** 2)
</pre>
</div>
</div>

<div id="outline-container-org431b7d8" class="outline-4">
<h4 id="org431b7d8">Gradient</h4>
<div class="outline-text-4" id="text-org431b7d8">
<p>
The <code>firstDerivative</code> function above can then be used to numerically evaluate
the gradient
</p>

<div class="org-src-container">
<pre class="src src-haskell">-- | The gradient vector computed using 'firstDerivative'.
gradient :: Floating a =&gt; a -&gt; ([a] -&gt; a) -&gt; [a] -&gt; [a]
gradient h f x =
  let n = length x
      es = [replicate (i-1) 0 ++ [1] ++ replicate (n-i) 0 | i &lt;- [1..n]]
      g e d = f [xi + d * ei | (xi,ei) &lt;- zip x e]
  in [firstDerivative h (g e) 0.0 | e &lt;- es]
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5d00e08" class="outline-3">
<h3 id="org5d00e08">Mathematical optimisation</h3>
<div class="outline-text-3" id="text-org5d00e08">
</div>
<div id="outline-container-org4116550" class="outline-4">
<h4 id="org4116550">Nelder-Mead</h4>
<div class="outline-text-4" id="text-org4116550">
<p>
The Nelder-Mead algorithm is a gradient free method which is a simple way to get
a rough estimate. The <span class="underline">rule of thumb</span> for the number of iterations to use for
this algorithm should be roughly 20&#x2013;200 times the dimension of the search
space.
</p>
</div>
</div>

<div id="outline-container-org2187a54" class="outline-4">
<h4 id="org2187a54">Golden section</h4>
<div class="outline-text-4" id="text-org2187a54">
<p>
The golden section algorithm is a gradient free method which can be used to
obtain an estimate up to a precision of about \(\sqrt{\epsilon}\) where
\(\epsilon\) is machine precision. To initialise it, three points are needed,
\(a,b,c\) such that \(a < b < c\) and \(f(a) > f(b) < f(c)\). The name comes
from the fact that one of the parameters of the algorithm is the golden ratio.
</p>

<div class="org-src-container">
<pre class="src src-haskell">data Golden = Golden { gPoint      :: Double
		     , gValue      :: Double
		     , gDerivative :: Double } deriving (Show)

-- | Bracket the minimum
--
-- &gt;&gt;&gt; bracket (\x -&gt; x * (x - 1)) 0 0.1
--
bracket :: (Double -&gt; Double)
	-&gt; Double
	-&gt; Double
	-&gt; Either String (Double,Double,Double)
bracket f a b =
  let g = 1.618034
      c = b + g * (b - a)
      (fa, fb, fc) = (f a, f b, f c)
      in if | a &gt; b     -&gt; bracket f b a
	    | fa &lt; fb   -&gt; Left "initial points given to bracket do not go downhill"
	    | fb &lt; fc   -&gt; Right (a,b,c)
	    | otherwise -&gt; bracket f b c

-- | Golden section search.
--
-- &gt;&gt;&gt; golden (\x -&gt; x * (x - 1)) (0.26,0.52,0.94)
--
golden :: (Double -&gt; Double)
       -&gt; (Double,Double,Double)
       -&gt; Either String Golden
golden f (a,b,c) =
  let
    r = 0.61803399
    tol = 3.0e-8
    (fa,fb,fc) = (f a,f b,f c)
    (x0,x3) = (a,c)
    (x1,x2) = if abs (c-b) &gt; abs (b-a)
	      then (b,r*b+(1-r)*c)
	      else ((1-r)*a+r*b,b)
    (xmin,fmin) = gwl r tol f (x0,x1,x2,x3) (f x1,f x2)
    fder = firstDerivative tol f xmin
  in if a &lt; b &amp;&amp; b &lt; c &amp;&amp; fa &gt; fb &amp;&amp; fb &lt; fc
     then Right $ Golden xmin fmin fder
     else Left "invalid triple given to golden"

-- | Golden while loop
gwl :: Double
    -&gt; Double
    -&gt; (Double -&gt; Double)
    -&gt; (Double,Double,Double,Double)
    -&gt; (Double,Double)
    -&gt; (Double,Double)
gwl r tol f (x0,x1,x2,x3) (f1,f2) =
  if abs (x3 - x0) &gt; tol * (abs x1 + abs x2)
  then if f2 &lt; f1
       then let x' = r*x2+(1-r)*x3
	    in gwl r tol f (x1,x2,x',x3) (f2,f x')
       else let x' = r*x1+(1-r)*x0
	    in gwl r tol f (x0,x',x1,x2) (f2,f x')
  else if f1 &lt; f2
       then (x1,f1)
       else (x2,f2)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb9f47f4" class="outline-3">
<h3 id="orgb9f47f4">LogSumExp function</h3>
<div class="outline-text-3" id="text-orgb9f47f4">
<p>
Consider the LogSumExp (LSE) function
</p>

<p>
\[
\text{LSE}(x_1,\dots,x_n) = \log\left(\sum_i e^{x_i}\right).
\]
</p>

<p>
Let \(x^* = \max\{x_i\}\) and this can equally be expressed as
</p>

<p>
\[
x^* + \log\left(\sum_i e^{x_i - x^*}\right)
\]
</p>

<p>
which only takes the exponents of numbers closer to zero and hence can will not
overflow or underflow as easily.
</p>

<div class="org-src-container">
<pre class="src src-haskell">logSumExp :: (Floating a, Ord a) =&gt; [a] -&gt; a
logSumExp xs = x' + log (sum [exp (x - x') | x &lt;- xs])
	       where x' = maximum xs
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c8da8e" class="outline-3">
<h3 id="org0c8da8e">Combinatoric functions</h3>
<div class="outline-text-3" id="text-org0c8da8e">
<p>
The following is taken from the <code>math-functions</code> haskell package which
demonstrates some useful implementations of functions for working with binomial
coefficients.
</p>

<div class="org-src-container">
<pre class="src src-haskell">----------------------------------------------------------------
-- Combinatorics
----------------------------------------------------------------

-- |
-- Quickly compute the natural logarithm of /n/ @`choose`@ /k/, with
-- no checking.
--
-- Less numerically stable:
--
-- &gt; exp $ lg (n+1) - lg (k+1) - lg (n-k+1)
-- &gt;   where lg = logGamma . fromIntegral
logChooseFast :: Double -&gt; Double -&gt; Double
logChooseFast n k = -log (n + 1) - logBeta (n - k + 1) (k + 1)

-- | Calculate binomial coefficient using exact formula
chooseExact :: Int -&gt; Int -&gt; Double
n `chooseExact` k
  = U.foldl' go 1 $ U.enumFromTo 1 k
  where
    go a i      = a * (nk + j) / j
	where j = fromIntegral i :: Double
    nk = fromIntegral (n - k)

-- | Compute logarithm of the binomial coefficient.
logChoose :: Int -&gt; Int -&gt; Double
n `logChoose` k
    | k  &gt; n    = (-1) / 0
      -- For very large N exact algorithm overflows double so we
      -- switch to beta-function based one
    | k' &lt; 50 &amp;&amp; (n &lt; 20000000) = log $ chooseExact n k'
    | otherwise                 = logChooseFast (fromIntegral n) (fromIntegral k)
  where
    k' = min k (n-k)

-- | Compute the binomial coefficient /n/ @\``choose`\`@ /k/. For
-- values of /k/ &gt; 50, this uses an approximation for performance
-- reasons.  The approximation is accurate to 12 decimal places in the
-- worst case
--
-- Example:
--
-- &gt; 7 `choose` 3 == 35
choose :: Int -&gt; Int -&gt; Double
n `choose` k
    | k  &gt; n         = 0
    | k' &lt; 50        = chooseExact n k'
    | approx &lt; max64 = fromIntegral . round64 $ approx
    | otherwise      = approx
  where
    k'             = min k (n-k)
    approx         = exp $ logChooseFast (fromIntegral n) (fromIntegral k')
    max64          = fromIntegral (maxBound :: Int64)
    round64 x      = round x :: Int64
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc5c464d" class="outline-3">
<h3 id="orgc5c464d">Factorial</h3>
<div class="outline-text-3" id="text-orgc5c464d">
<p>
The factorial function has the following definition for positive integers
</p>

<p>
\[
n! = n \cdot (n-1) \cdot (n-2) \cdot \dots \cdot 2 \cdot 1
\]
</p>

<p>
It is related to the gamma function by \(x! = \Gamma ( x + 1)\). So you only
need a safe implementation of the gamma function to work with factorials.
</p>
</div>
</div>

<div id="outline-container-org286033b" class="outline-3">
<h3 id="org286033b">Pochhammer</h3>
<div class="outline-text-3" id="text-org286033b">
<p>
For a positive integer, \(n\), the Pochhammer function, rising factorial, is
given by
</p>

<p>
\[
x^{(n)} = x \cdot (x+1) \cdot \dots \cdot (x+n-1) = \prod_{i=0}^{n-1} (x+i)
\]
</p>

<p>
with \(x^{(0)} = 1\). It is related to the factorial function and gamma function
</p>

<p>
\[
x^{(n)} = \frac{(x + n - 1)!}{(x-1)!} = \frac{\Gamma(x+n)}{\Gamma(x)}
\]
</p>

<p>
So you only need a safe implementation of the gamma function to work with the
Pochhammer function.
</p>
</div>
</div>

<div id="outline-container-orga6f9c60" class="outline-3">
<h3 id="orga6f9c60">Computational complexity</h3>
<div class="outline-text-3" id="text-orga6f9c60">
<p>
Suppose you have a program that depends on a parameter <code>n</code> and takes <code>t</code> seconds
to evaluate. The following snippet can be used as a starting point for
estimating how long it will take to run on a larger input.
</p>

<div class="org-src-container">
<pre class="src src-R">df &lt;- data.frame(t = c(38,106,255,847), n = c(180,190,200,210))

ggplot(data = df, mapping = aes(x = n, y = t / 60)) +
  geom_point() +
  scale_y_log10(n.breaks = 10) +
  geom_smooth(method = "lm", fullrange = TRUE) +
  xlim(c(170, 220))
</pre>
</div>

<p>
Of course, this assumes an exponential complexity, but is easy to tweak for
polynomial complexity.
</p>
</div>

<div id="outline-container-org643bfe3" class="outline-4">
<h4 id="org643bfe3">Time</h4>
<div class="outline-text-4" id="text-org643bfe3">
<p>
Here is a table that might help you decide is something runs fast enough.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Seconds</th>
<th scope="col" class="org-left">Convenient</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(10^{0}\)</td>
<td class="org-left">\(<1\) minute</td>
</tr>

<tr>
<td class="org-left">\(10^{1}\)</td>
<td class="org-left">\(<1\) minute</td>
</tr>

<tr>
<td class="org-left">\(10^{2}\)</td>
<td class="org-left">\(\approx 2\) minute</td>
</tr>

<tr>
<td class="org-left">\(10^{3}\)</td>
<td class="org-left">\(\approx 20\) minutes</td>
</tr>

<tr>
<td class="org-left">\(10^{4}\)</td>
<td class="org-left">\(\approx 3\) hours</td>
</tr>

<tr>
<td class="org-left">\(10^{5}\)</td>
<td class="org-left">\(\approx 1\) day</td>
</tr>

<tr>
<td class="org-left">\(10^{6}\)</td>
<td class="org-left">\(\approx 10\) days</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org6ab6d76" class="outline-3">
<h3 id="org6ab6d76">Caching results</h3>
<div class="outline-text-3" id="text-org6ab6d76">
<p>
Consider the following Java programs. The first one computes the logarithms each
time they are used.
</p>

<div class="org-src-container">
<pre class="src src-java">public class AAA {
    public static void main(String[] args) {
	double size = 100000;
	double answer = 1051287.7089736538;
	int repeats = Integer.parseInt(args[0]);
	for (int m = 0; m &lt; repeats; m++) {
	    double x = 0;
	    for (double n = 1.0; n &lt; size; n+=1.0) {
		x += Math.log(n);
	    }
	    if (x != answer) {
		throw new RuntimeException("incorrect value");
	    }
	}
    }
}
</pre>
</div>

<p>
The second saves the results in an array and re-uses them.
</p>

<div class="org-src-container">
<pre class="src src-java">public class BBB {
    public static void main(String[] args) {
	int size = 100000;
	double answer = 1051287.7089736538;
	int repeats = Integer.parseInt(args[0]);
	double[] ls;
	ls = new double[size+1];
	for (int ix = 0; ix &lt;= size; ix++) {
	    ls[ix] = Math.log(ix);
	}

	for (int m = 0; m &lt; repeats; m++) {
	    double x = 0;
	    for (int n = 1; n &lt; size; n++) {
		x += ls[n];
	    }
	    if (x != answer) {
		throw new RuntimeException("incorrect value");
	    }
	}
    }
}
</pre>
</div>

<p>
Running this program with varying number of repeats and timing the evaluation
produces the dataset shown in Listing <a href="#org6f059b1">1</a> which is also shown in Figure <a href="#orgb717740">1</a>. This
shows that for even reasonably small problems it is useful to cache results.
</p>


<div id="orgb717740" class="figure">
<p><img src="../images/java-log-timing.png" alt="java-log-timing.png" width="400px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-csv" id="org6f059b1">method,repeats,seconds
AAA,100,0.286
AAA,200,0.474
AAA,300,0.612
AAA,400,0.781
AAA,500,0.945
AAA,600,1.154
AAA,700,1.312
AAA,800,1.521
AAA,900,1.712
AAA,1000,1.764
AAA,1100,2.084
AAA,1200,2.177
AAA,1300,2.397
AAA,1400,2.619
AAA,1500,2.661
BBB,100,0.133
BBB,200,0.128
BBB,300,0.156
BBB,400,0.154
BBB,500,0.169
BBB,600,0.174
BBB,700,0.177
BBB,800,0.186
BBB,900,0.178
BBB,1000,0.240
BBB,1100,0.205
BBB,1200,0.229
BBB,1300,0.248
BBB,1400,0.254
BBB,1500,0.272
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alex Zarebski</p>
<p class="date">Created: 2022-04-17 Sun 14:21</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
