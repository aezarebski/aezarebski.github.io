<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-05-25 Wed 11:38 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>git-aez-notes</title>
<meta name="author" content="Alex Zarebski" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet.css" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">git-aez-notes</h1>
<p>
<a href="../index.html">Home</a>
</p>


<div id="org051aff6" class="figure">
<p><img src="../images/git-logo.png" alt="git-logo.png" width="300px" />
</p>
</div>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org23d0030">Git notes</a>
<ul>
<li><a href="#org62855ee">List current commit hash</a></li>
<li><a href="#org980ac5e">Listing the files git cares about</a></li>
<li><a href="#org76fefb6">Listing when a file was first added to a repository</a></li>
<li><a href="#orgc83390b">List changes that would be done by pulling</a></li>
<li><a href="#org3a2bda5">List branch topology</a></li>
<li><a href="#orga536f19">Update remote to use ssh</a></li>
<li><a href="#org3b97cd7">Undo a commit</a></li>
<li><a href="#orgbfc315e">Unstage all staged files</a></li>
<li><a href="#org74280c1">Repository and file sizes</a></li>
<li><a href="#orgb85de38">Bringing fork up to date</a></li>
<li><a href="#org8c495a4">Bringing branch up to date</a></li>
<li><a href="#orgbef3b46">Branches</a></li>
<li><a href="#org109994e">Visiting an old commit</a></li>
<li><a href="#orgda201ea">Magit via spacemacs</a></li>
<li><a href="#org0b0cf13">Editor</a></li>
</ul>
</li>
<li><a href="#orgf60b819">GitHub</a>
<ul>
<li><a href="#orgb1914a2">ssh keys</a></li>
<li><a href="#org13141b2">Wikis</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org23d0030" class="outline-2">
<h2 id="org23d0030">Git notes</h2>
<div class="outline-text-2" id="text-org23d0030">
</div>
<div id="outline-container-org62855ee" class="outline-3">
<h3 id="org62855ee">List current commit hash</h3>
<div class="outline-text-3" id="text-org62855ee">
<div class="org-src-container">
<pre class="src src-sh">git log -1 --format="%H"
</pre>
</div>
</div>
</div>

<div id="outline-container-org980ac5e" class="outline-3">
<h3 id="org980ac5e">Listing the files git cares about</h3>
<div class="outline-text-3" id="text-org980ac5e">
<div class="org-src-container">
<pre class="src src-sh">git ls-files
</pre>
</div>
</div>
</div>

<div id="outline-container-org76fefb6" class="outline-3">
<h3 id="org76fefb6">Listing when a file was first added to a repository</h3>
<div class="outline-text-3" id="text-org76fefb6">
<div class="org-src-container">
<pre class="src src-sh">git log --diff-filter=A -- &lt;path/to/file&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc83390b" class="outline-3">
<h3 id="orgc83390b">List changes that would be done by pulling</h3>
<div class="outline-text-3" id="text-orgc83390b">
<p>
The dry run form of fetch will list the changes that would be made by <code>git pull</code>
but does not actually make any changes to the code.
</p>

<div class="org-src-container">
<pre class="src src-sh">git fetch --dry-run
</pre>
</div>
</div>
</div>

<div id="outline-container-org3a2bda5" class="outline-3">
<h3 id="org3a2bda5">List branch topology</h3>
<div class="outline-text-3" id="text-org3a2bda5">
<p>
Stackoverflow has <a href="https://stackoverflow.com/a/1838881/15291819">this answer</a>
</p>

<div class="org-src-container">
<pre class="src src-sh">git log --graph --decorate --oneline
</pre>
</div>
</div>
</div>

<div id="outline-container-orga536f19" class="outline-3">
<h3 id="orga536f19">Update remote to use ssh</h3>
<div class="outline-text-3" id="text-orga536f19">
<p>
To find where the current remote is there is the following command
</p>

<div class="org-src-container">
<pre class="src src-shell">git remote -v
</pre>
</div>

<p>
Once you have registered your keys with the remote, you can update the
repository settings with the following.
</p>

<div class="org-src-container">
<pre class="src src-shell">git remote set-url origin git@(github.com|bitbucket.org):azarebski/&lt;repositoryname&gt;.git
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b97cd7" class="outline-3">
<h3 id="org3b97cd7">Undo a commit</h3>
<div class="outline-text-3" id="text-org3b97cd7">
<p>
There is an <code>amend</code> function for modifying an existing commit. If you want to
completely undo the last commit though, issue the following command
</p>

<div class="org-src-container">
<pre class="src src-shell">git reset --hard HEAD~1
</pre>
</div>

<p>
Or if you want to go back to a particular commit, issue the following command
</p>

<div class="org-src-container">
<pre class="src src-shell">git reset --hard &lt;commit-sha&gt;
</pre>
</div>

<p>
The <code>--hard</code> part is so that the changes made are removed, if you wanted to keep
the changes it would be <code>--soft</code>.
</p>
</div>
</div>

<div id="outline-container-orgbfc315e" class="outline-3">
<h3 id="orgbfc315e">Unstage all staged files</h3>
<div class="outline-text-3" id="text-orgbfc315e">
<div class="org-src-container">
<pre class="src src-shell">git reset
</pre>
</div>
</div>
</div>

<div id="outline-container-org74280c1" class="outline-3">
<h3 id="org74280c1">Repository and file sizes</h3>
<div class="outline-text-3" id="text-org74280c1">
<p>
GitHub <a href="https://docs.github.com/en/github/managing-large-files/what-is-my-disk-quota">recommends</a> that repositories are kept below 1GB and that individual files
are all kept below 100MB. There are ways around this, but this sensible to keep
things running smoothly.
</p>
</div>
</div>

<div id="outline-container-orgb85de38" class="outline-3">
<h3 id="orgb85de38">Bringing fork up to date</h3>
<div class="outline-text-3" id="text-orgb85de38">
<div class="org-src-container">
<pre class="src src-shell">git remote add upstream &lt;URL&gt;
git fetch upstream
git merge upstream/master master
</pre>
</div>

<p>
Keep in mind that this only brings your local repository up to date, you still
need to push this if you want the other clones to be up to date. Also, this can
be a slow process if your fork is a long way behind, so it might be wise to do
this regularly.
</p>
</div>
</div>

<div id="outline-container-org8c495a4" class="outline-3">
<h3 id="org8c495a4">Bringing branch up to date</h3>
<div class="outline-text-3" id="text-org8c495a4">
<p>
Suppose you want to bring edits on <code>main</code> into your development branch, <code>dev</code>.
</p>

<div class="org-src-container">
<pre class="src src-shell">git checkout dev
git merge master --no-ff
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbef3b46" class="outline-3">
<h3 id="orgbef3b46">Branches</h3>
<div class="outline-text-3" id="text-orgbef3b46">
</div>
<div id="outline-container-orgad8fb2a" class="outline-4">
<h4 id="orgad8fb2a">Finalising a merge</h4>
<div class="outline-text-4" id="text-orgad8fb2a">
<p>
The tool <code>meld</code> is a GUI which greatly simplifies the task of refining what code
to take from which branch. Suppose you are on branch <code>X</code> and you want to pull
some stuff over from branch <code>Y</code>. Check out branch <code>X</code> and run the following
</p>

<div class="org-src-container">
<pre class="src src-sh">git difftool Y
</pre>
</div>

<p>
This will ask you if you want to use meld to resolve difference for the files
with differences. You can install <code>meld</code> with your package manager on linux.
</p>

<p>
If you only want to consider a subset of files when using this, you can add a
path argument to the end of the command to restrict it to just files matching
that path.
</p>
</div>
</div>

<div id="outline-container-org0b01af9" class="outline-4">
<h4 id="org0b01af9">Query</h4>
<div class="outline-text-4" id="text-org0b01af9">
<p>
The following shows a visualisation of the commits among all the branches.
</p>

<div class="org-src-container">
<pre class="src src-shell">git log --all --decorate --oneline --graph
</pre>
</div>

<p>
To get a list of the filenames of the files that differ between commits use the
following
</p>

<div class="org-src-container">
<pre class="src src-shell">git diff --name-only SHA1 SHA2
</pre>
</div>

<p>
You can also get a list of just the names of the files that differ between your
current branching with the following command.
</p>

<div class="org-src-container">
<pre class="src src-sh">git diff &lt;otherBranchName&gt; --name-only
</pre>
</div>
</div>
</div>

<div id="outline-container-orga7791b8" class="outline-4">
<h4 id="orga7791b8">Cautious merging</h4>
<div class="outline-text-4" id="text-orga7791b8">
<p>
You can merge a branch without committing the results and squashing the commits
in the branch with the following
</p>

<div class="org-src-container">
<pre class="src src-shell">git merge --squash --no-commit &lt;branch&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org1363fe1" class="outline-4">
<h4 id="org1363fe1">Squashing commits</h4>
<div class="outline-text-4" id="text-org1363fe1">
<p>
Suppose you have a <code>master</code> branch and a <code>feature-messy</code> branch. The
<code>feature-messy</code> branch has a bunch of messy commits. The following steps allow
you to include all the work from <code>feature-messy</code> into a single commit in a new
branch, <code>feature-neat</code>, which can then be merged into master without looking
messy.
</p>

<div class="org-src-container">
<pre class="src src-shell">git checkout master
git checkout -b feature-neat
git checkout feature-neat
git merge --squash feature-messy
git commit # This step may require more attention
git checkout master
git merge feature-neat
</pre>
</div>
</div>
</div>

<div id="outline-container-orga20121c" class="outline-4">
<h4 id="orga20121c">Updating a feature branch</h4>
<div class="outline-text-4" id="text-orga20121c">
<p>
Suppose after working on <code>feature-branch</code> for a while you want to bring it up to
date with changes that have happened on <code>master</code>. The following is taken for a
<a href="https://gist.github.com/santisbon/a1a60db1fb8eecd1beeacd986ae5d3ca#file-update-branch-md">gist</a> explaining how to do just that!
</p>

<div class="org-src-container">
<pre class="src src-shell">git checkout master
git fetch -p origin
git merge origin/master
git checkout &lt;feature-branch&gt;
git merge master
git push origin &lt;feature-branch&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgccb6317" class="outline-4">
<h4 id="orgccb6317">Checking out edits to single files</h4>
<div class="outline-text-4" id="text-orgccb6317">
<p>
Suppose you are on branch <code>X</code> and there are edits to files <code>f1</code> and <code>f2</code> that
you want from branch <code>Y</code>. To pull those edits over you can do the following.
</p>

<div class="org-src-container">
<pre class="src src-sh">git checkout X                  # we need to be on X
git checkout Y f1 f2            # checkout out the edited files
git commit -m "Pull edits over" # Profit!
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org109994e" class="outline-3">
<h3 id="org109994e">Visiting an old commit</h3>
<div class="outline-text-3" id="text-org109994e">
<p>
To check what something looked like in an old commit, find the commit hash and
use <code>git checkout &lt;hash&gt;</code>. Once you are finished looking around go back to the
branch you're working on with <code>git checkout &lt;branch&gt;</code>.
</p>

<p>
Magit allows you to look at the list of commits, get a preview of the edit made
in that commit and then check out the revision from the log menu.
</p>
</div>
</div>

<div id="outline-container-orgda201ea" class="outline-3">
<h3 id="orgda201ea">Magit via spacemacs</h3>
<div class="outline-text-3" id="text-orgda201ea">
<p>
I have some notes on the <a href="../notes/spacemacs-notes.html">magit</a> git client too!
</p>
</div>
</div>
<div id="outline-container-org0b0cf13" class="outline-3">
<h3 id="org0b0cf13">Editor</h3>
<div class="outline-text-3" id="text-org0b0cf13">
<p>
The following command should set vim as the default editor on a machine.
</p>

<div class="org-src-container">
<pre class="src src-sh">git config --global core.editor "vim"
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf60b819" class="outline-2">
<h2 id="orgf60b819">GitHub</h2>
<div class="outline-text-2" id="text-orgf60b819">
</div>
<div id="outline-container-orgb1914a2" class="outline-3">
<h3 id="orgb1914a2">ssh keys</h3>
<div class="outline-text-3" id="text-orgb1914a2">
<p>
The following is copied from this <a href="https://stackoverflow.com/a/25623759/15291819">stackoverflow answer</a>. To generate some keys do
the following
</p>

<div class="org-src-container">
<pre class="src src-shell">cd ~/.ssh
ssh-keygen
</pre>
</div>

<p>
then go to the Settings in GitHub and copy the <b>public</b> key github account.
Finally run
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh -T git@github.com
</pre>
</div>

<p>
and GitHub should respond with a message saying that you're all set to go.
</p>
</div>
</div>

<div id="outline-container-org13141b2" class="outline-3">
<h3 id="org13141b2">Wikis</h3>
<div class="outline-text-3" id="text-org13141b2">
<p>
GitHub saves wikis as git repos. The wiki is stored in a repository with the
same name but with a <code>.wiki.git</code> suffix rather than <code>.git</code>. For example, if you
clone the <code>foobar</code> repo with
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone git@github.com:myusername/foobar.git
</pre>
</div>

<p>
then you clone the wiki for this repository with
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone git@github.com:myusername/foobar.wiki.git
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alex Zarebski</p>
<p class="date">Created: 2022-05-25 Wed 11:38</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
