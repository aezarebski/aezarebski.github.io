<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-11-09 Tue 18:40 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>aez-notes-beast2</title>
<meta name="author" content="Alex Zarebski" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet-dark.css" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">aez-notes-beast2</h1>
<p>
<a href="../index.html">Home</a>
</p>

<button type="button" onclick="toggleStyle()">Light/Dark</button>
<script src="./main.js"></script>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org3f61c1b">Links</a></li>
<li><a href="#org791a8df">Examples</a>
<ul>
<li><a href="#org0cae390">BEAST2 as an MCMC engine: part I</a></li>
<li><a href="#org71098bf">BEAST2 as an MCMC engine: part II</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3f61c1b" class="outline-2">
<h2 id="org3f61c1b">Links</h2>
<div class="outline-text-2" id="text-org3f61c1b">
<ul class="org-ul">
<li><a href="https://github.com/CompEvol/beast2">BEAST2 repository</a></li>
<li><a href="https://github.com/tgvaughan/feast">feast</a> a collection of resources from Tim Vaughan</li>
<li><a href="https://github.com/laduplessis/skylinetools">skylinetools</a> is a package from Louis du Plessis which has skylining
functionality, (the <code>DateParser</code> constructor has a nifty trick.)</li>
</ul>
</div>
</div>

<div id="outline-container-org791a8df" class="outline-2">
<h2 id="org791a8df">Examples</h2>
<div class="outline-text-2" id="text-org791a8df">
</div>
<div id="outline-container-org0cae390" class="outline-3">
<h3 id="org0cae390">BEAST2 as an MCMC engine: part I</h3>
<div class="outline-text-3" id="text-org0cae390">
<p>
This example looks at how to use BEAST2 to simulate from a standard normal
distribution using MCMC. The XML for this has the following structure
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #3a81c3; font-weight: bold;">xml</span> <span style="color: #da8b55;">version="1.0" encoding="UTF-8" standalone="no"</span>?&gt;
&lt;<span style="color: #6c3163; font-weight: bold;">beast</span> <span style="color: #715ab1;">version</span>=<span style="color: #2d9574;">"2.0"</span>&gt;

  &lt;&lt;<span style="color: #6c3163; font-weight: bold;">targetDistribution</span>&gt;&gt;

  &lt;&lt;<span style="color: #6c3163; font-weight: bold;">mcmc</span>&gt;&gt;

&lt;/<span style="color: #6c3163; font-weight: bold;">beast</span>&gt;
</pre>
</div>

<p>
The <a href="#org94fd60f"><code>targetDistribution</code></a> specifies the distribution we will sample from and the <a href="#orgb641241">mcmc</a> specifies how details of the MCMC algorithm.
</p>
</div>

<div id="outline-container-org94fd60f" class="outline-4">
<h4 id="org94fd60f">The target distribution</h4>
<div class="outline-text-4" id="text-org94fd60f">
<p>
We use a <code>Prior</code> to represent the distribution because this makes it easy to
evaluate the distribution at a particular value.
</p>

<div class="org-src-container">
<pre class="src src-xml" id="org4371404">&lt;<span style="color: #6c3163; font-weight: bold;">distribution</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"posterior"</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.math.distributions.Prior"</span> <span style="color: #715ab1;">x</span>=<span style="color: #2d9574;">"@x"</span>&gt;
  &lt;<span style="color: #6c3163; font-weight: bold;">distr</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.math.distributions.Normal"</span> <span style="color: #715ab1;">mean</span>=<span style="color: #2d9574;">"0.0"</span> <span style="color: #715ab1;">sigma</span>=<span style="color: #2d9574;">"1.0"</span> /&gt;
&lt;/<span style="color: #6c3163; font-weight: bold;">distribution</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb641241" class="outline-4">
<h4 id="orgb641241">MCMC</h4>
<div class="outline-text-4" id="text-orgb641241">
<p>
We use a <code>run</code> tag to specify the MCMC. This requires a <code>state</code> object to
describe the parameters we are sampling, the <code>distribution</code> over the state, and
an <code>operator</code> and <code>logger</code> to perturb the state and record the results.
</p>

<div class="org-src-container">
<pre class="src src-xml" id="orgb21e102">&lt;<span style="color: #6c3163; font-weight: bold;">run</span> <span style="color: #715ab1;">chainLength</span>=<span style="color: #2d9574;">"10000000"</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"mcmc"</span> <span style="color: #715ab1;">preBurnin</span>=<span style="color: #2d9574;">"100"</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.core.MCMC"</span>&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">state</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"state"</span> <span style="color: #715ab1;">storeEvery</span>=<span style="color: #2d9574;">"1000"</span>&gt;
        &lt;<span style="color: #6c3163; font-weight: bold;">parameter</span> <span style="color: #715ab1;">estimate</span>=<span style="color: #2d9574;">"true"</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"x"</span> <span style="color: #715ab1;">name</span>=<span style="color: #2d9574;">"stateNode"</span> <span style="color: #715ab1;">value</span>=<span style="color: #2d9574;">"1.0"</span> /&gt;
    &lt;/<span style="color: #6c3163; font-weight: bold;">state</span>&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">distribution</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"posterior"</span> /&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">operator</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.evolution.operators.RealRandomWalkOperator"</span>
              <span style="color: #715ab1;">windowSize</span>=<span style="color: #2d9574;">"0.1"</span>
              <span style="color: #715ab1;">useGaussian</span>=<span style="color: #2d9574;">"true"</span>
              <span style="color: #715ab1;">weight</span>=<span style="color: #2d9574;">"1.0"</span>
              <span style="color: #715ab1;">parameter</span>=<span style="color: #2d9574;">"@x"</span> /&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">logger</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"screenlog"</span> <span style="color: #715ab1;">logEvery</span>=<span style="color: #2d9574;">"1000000"</span>&gt;
        &lt;<span style="color: #6c3163; font-weight: bold;">log</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"x"</span> /&gt;
    &lt;/<span style="color: #6c3163; font-weight: bold;">logger</span>&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">logger</span> <span style="color: #715ab1;">fileName</span>=<span style="color: #2d9574;">"beast.csv"</span>
            <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"tracelog"</span>
            <span style="color: #715ab1;">logEvery</span>=<span style="color: #2d9574;">"10000"</span>
            <span style="color: #715ab1;">model</span>=<span style="color: #2d9574;">"@posterior"</span>&gt;
        &lt;<span style="color: #6c3163; font-weight: bold;">log</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"posterior"</span> /&gt;
        &lt;<span style="color: #6c3163; font-weight: bold;">log</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"x"</span> /&gt;
    &lt;/<span style="color: #6c3163; font-weight: bold;">logger</span>&gt;

&lt;/<span style="color: #6c3163; font-weight: bold;">run</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org1753a24" class="outline-4">
<h4 id="org1753a24">Running the sampler</h4>
<div class="outline-text-4" id="text-org1753a24">
<p>
Here is the command to actually run this program.
</p>

<div class="org-src-container">
<pre class="src src-sh">java -jar beast.jar -seed <span style="color: #4e3163;">1</span> -overwrite example-01.xml
</pre>
</div>

<p>
I have used the <code>-overwrite</code> flag because otherwise it will prompt you each time
unless you change the output file name.
</p>
</div>
</div>

<div id="outline-container-orge2f3888" class="outline-4">
<h4 id="orge2f3888">Visualising the results</h4>
<div class="outline-text-4" id="text-orge2f3888">
<p>
Here is a visualisation of the resulting samples along with the distribution we
were sampling from.
</p>


<div id="org0ff3e78" class="figure">
<p><img src="../images/beast-demo.png" alt="beast-demo.png" width="800px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #3a81c3;">library</span><span style="color: #3a81c3;">(</span>ggplot2<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">library</span><span style="color: #3a81c3;">(</span>cowplot<span style="color: #3a81c3;">)</span>

beast_samples <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> read.table<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"beast.csv"</span>,
  sep = <span style="color: #2d9574;">"\t"</span>,
  comment.char = <span style="color: #2d9574;">"#"</span>,
  header = <span style="color: #4e3163;">TRUE</span>
<span style="color: #3a81c3;">)</span>

g1 <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> ggplot<span style="color: #3a81c3;">()</span> +
  geom_line<span style="color: #3a81c3;">(</span>
    data = beast_samples,
    mapping = aes<span style="color: #6c3163;">(</span>x = Sample, y = x<span style="color: #6c3163;">)</span>
  <span style="color: #3a81c3;">)</span> +
  labs<span style="color: #3a81c3;">(</span>x = <span style="color: #2d9574;">"Sample"</span>, y = <span style="color: #2d9574;">"X"</span><span style="color: #3a81c3;">)</span> +
  theme_classic<span style="color: #3a81c3;">()</span>

g2 <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> ggplot<span style="color: #3a81c3;">()</span> +
  geom_histogram<span style="color: #3a81c3;">(</span>
    data = beast_samples,
    mapping = aes<span style="color: #6c3163;">(</span>x = x, y = ..density..<span style="color: #6c3163;">)</span>,
    bins = <span style="color: #4e3163;">10</span>
  <span style="color: #3a81c3;">)</span> +
  stat_function<span style="color: #3a81c3;">(</span>
    fun = \<span style="color: #6c3163;">(</span>x<span style="color: #6c3163;">)</span> dnorm<span style="color: #6c3163;">(</span>x<span style="color: #6c3163;">)</span>,
    geom = <span style="color: #2d9574;">"line"</span>
  <span style="color: #3a81c3;">)</span> +
  labs<span style="color: #3a81c3;">(</span>x = <span style="color: #2d9574;">"X"</span>, y = <span style="color: #2d9574;">"Density"</span><span style="color: #3a81c3;">)</span> +
  theme_classic<span style="color: #3a81c3;">()</span>

g <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> plot_grid<span style="color: #3a81c3;">(</span>g1, g2<span style="color: #3a81c3;">)</span>

ggsave<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"beast-demo.png"</span>,
       g,
       height = <span style="color: #4e3163;">10.5</span>,
       width = <span style="color: #4e3163;">14.8</span>,
       units = <span style="color: #2d9574;">"cm"</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org71098bf" class="outline-3">
<h3 id="org71098bf">BEAST2 as an MCMC engine: part II</h3>
<div class="outline-text-3" id="text-org71098bf">
<p>
This example looks at estimating the probability of heads in coin flips. We
start with at beta prior distribution and take values of the number of observed
heads and tails from the command line.
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #3a81c3; font-weight: bold;">xml</span> <span style="color: #da8b55;">version="1.0" encoding="UTF-8" standalone="no"</span>?&gt;
&lt;<span style="color: #6c3163; font-weight: bold;">beast</span> <span style="color: #715ab1;">version</span>=<span style="color: #2d9574;">"2.0"</span>&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">distribution</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"posterior"</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.core.util.CompoundDistribution"</span> &gt;
        &lt;<span style="color: #6c3163; font-weight: bold;">distribution</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"prior"</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.math.distributions.Prior"</span> <span style="color: #715ab1;">x</span>=<span style="color: #2d9574;">"@p"</span>&gt;
            &lt;<span style="color: #6c3163; font-weight: bold;">distr</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.math.distributions.Beta"</span> <span style="color: #715ab1;">alpha</span>=<span style="color: #2d9574;">"0.5"</span> <span style="color: #715ab1;">beta</span>=<span style="color: #2d9574;">"0.5"</span> /&gt;
        &lt;/<span style="color: #6c3163; font-weight: bold;">distribution</span>&gt;

        &lt;<span style="color: #6c3163; font-weight: bold;">distribution</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"likelihood"</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.math.distributions.Prior"</span> <span style="color: #715ab1;">x</span>=<span style="color: #2d9574;">"@p"</span>&gt;
            &lt;<span style="color: #6c3163; font-weight: bold;">distr</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.math.distributions.Beta"</span> <span style="color: #715ab1;">alpha</span>=<span style="color: #2d9574;">"$(heads)"</span> <span style="color: #715ab1;">beta</span>=<span style="color: #2d9574;">"$(tails)"</span> /&gt;
        &lt;/<span style="color: #6c3163; font-weight: bold;">distribution</span>&gt;
    &lt;/<span style="color: #6c3163; font-weight: bold;">distribution</span>&gt;

    &lt;<span style="color: #6c3163; font-weight: bold;">run</span> <span style="color: #715ab1;">chainLength</span>=<span style="color: #2d9574;">"10000000"</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"mcmc"</span> <span style="color: #715ab1;">preBurnin</span>=<span style="color: #2d9574;">"100"</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.core.MCMC"</span>&gt;

        &lt;<span style="color: #6c3163; font-weight: bold;">state</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"state"</span> <span style="color: #715ab1;">storeEvery</span>=<span style="color: #2d9574;">"1000"</span>&gt;
            &lt;<span style="color: #6c3163; font-weight: bold;">parameter</span> <span style="color: #715ab1;">estimate</span>=<span style="color: #2d9574;">"true"</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"p"</span> <span style="color: #715ab1;">name</span>=<span style="color: #2d9574;">"stateNode"</span> <span style="color: #715ab1;">value</span>=<span style="color: #2d9574;">"0.5"</span> /&gt;
        &lt;/<span style="color: #6c3163; font-weight: bold;">state</span>&gt;

        &lt;<span style="color: #6c3163; font-weight: bold;">distribution</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"posterior"</span> /&gt;

        &lt;<span style="color: #6c3163; font-weight: bold;">operator</span> <span style="color: #715ab1;">spec</span>=<span style="color: #2d9574;">"beast.evolution.operators.RealRandomWalkOperator"</span> <span style="color: #715ab1;">windowSize</span>=<span style="color: #2d9574;">"0.1"</span> <span style="color: #715ab1;">useGaussian</span>=<span style="color: #2d9574;">"true"</span> <span style="color: #715ab1;">weight</span>=<span style="color: #2d9574;">"1.0"</span> <span style="color: #715ab1;">parameter</span>=<span style="color: #2d9574;">"@p"</span> /&gt;

        &lt;<span style="color: #6c3163; font-weight: bold;">logger</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"screenlog"</span> <span style="color: #715ab1;">logEvery</span>=<span style="color: #2d9574;">"1000000"</span>&gt;
            &lt;<span style="color: #6c3163; font-weight: bold;">log</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"p"</span> /&gt;
        &lt;/<span style="color: #6c3163; font-weight: bold;">logger</span>&gt;

        &lt;<span style="color: #6c3163; font-weight: bold;">logger</span> <span style="color: #715ab1;">fileName</span>=<span style="color: #2d9574;">"beast-02.csv"</span> <span style="color: #715ab1;">id</span>=<span style="color: #2d9574;">"tracelog"</span> <span style="color: #715ab1;">logEvery</span>=<span style="color: #2d9574;">"10000"</span> <span style="color: #715ab1;">model</span>=<span style="color: #2d9574;">"@posterior"</span>&gt;
            &lt;<span style="color: #6c3163; font-weight: bold;">log</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"posterior"</span> /&gt;
            &lt;<span style="color: #6c3163; font-weight: bold;">log</span> <span style="color: #715ab1;">idref</span>=<span style="color: #2d9574;">"p"</span> /&gt;
        &lt;/<span style="color: #6c3163; font-weight: bold;">logger</span>&gt;

    &lt;/<span style="color: #6c3163; font-weight: bold;">run</span>&gt;

&lt;/<span style="color: #6c3163; font-weight: bold;">beast</span>&gt;
</pre>
</div>
</div>

<div id="outline-container-orgb736284" class="outline-4">
<h4 id="orgb736284">Running the sampler</h4>
<div class="outline-text-4" id="text-orgb736284">
<p>
Here is the command to actually run this program.
</p>

<div class="org-src-container">
<pre class="src src-sh">java -jar beast.jar -seed <span style="color: #4e3163;">1</span> -overwrite -D <span style="color: #2d9574;">"heads=3,tails=7"</span> example-02.xml
</pre>
</div>

<p>
The <code>-D</code> flag has been used to specify how many times the coin came up heads and
tails.
</p>
</div>
</div>

<div id="outline-container-org3ef4a7b" class="outline-4">
<h4 id="org3ef4a7b">Visualising the results</h4>
<div class="outline-text-4" id="text-org3ef4a7b">
<p>
Here is a visualisation of the resulting samples along with the distribution we
were sampling from.
</p>


<div id="org1e2029f" class="figure">
<p><img src="../images/beast-02.png" alt="beast-02.png" width="800px" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R"><span style="color: #3a81c3;">library</span><span style="color: #3a81c3;">(</span>ggplot2<span style="color: #3a81c3;">)</span>
<span style="color: #3a81c3;">library</span><span style="color: #3a81c3;">(</span>cowplot<span style="color: #3a81c3;">)</span>

beast_samples <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> read.table<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"beast-02.csv"</span>,
  sep = <span style="color: #2d9574;">"\t"</span>,
  comment.char = <span style="color: #2d9574;">"#"</span>,
  header = <span style="color: #4e3163;">TRUE</span>
<span style="color: #3a81c3;">)</span>

g1 <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> ggplot<span style="color: #3a81c3;">()</span> +
  geom_line<span style="color: #3a81c3;">(</span>
    data = beast_samples,
    mapping = aes<span style="color: #6c3163;">(</span>x = Sample, y = p<span style="color: #6c3163;">)</span>
  <span style="color: #3a81c3;">)</span> +
  labs<span style="color: #3a81c3;">(</span>x = <span style="color: #2d9574;">"Sample"</span>, y = <span style="color: #2d9574;">"p"</span><span style="color: #3a81c3;">)</span> +
  theme_classic<span style="color: #3a81c3;">()</span>

g2 <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> ggplot<span style="color: #3a81c3;">()</span> +
  geom_histogram<span style="color: #3a81c3;">(</span>
    data = beast_samples,
    mapping = aes<span style="color: #6c3163;">(</span>x = p, y = ..density..<span style="color: #6c3163;">)</span>,
    bins = <span style="color: #4e3163;">15</span>
  <span style="color: #3a81c3;">)</span> +
  stat_function<span style="color: #3a81c3;">(</span>
    fun = \<span style="color: #6c3163;">(</span>x<span style="color: #6c3163;">)</span> dbeta<span style="color: #6c3163;">(</span>x, <span style="color: #4e3163;">0.5</span> + <span style="color: #4e3163;">3</span>, <span style="color: #4e3163;">0.5</span> + <span style="color: #4e3163;">7</span><span style="color: #6c3163;">)</span>,
    geom = <span style="color: #2d9574;">"line"</span>
  <span style="color: #3a81c3;">)</span> +
  labs<span style="color: #3a81c3;">(</span>x = <span style="color: #2d9574;">"X"</span>, y = <span style="color: #2d9574;">"Density"</span><span style="color: #3a81c3;">)</span> +
  theme_classic<span style="color: #3a81c3;">()</span>

g <span style="color: #ba2f59; font-weight: bold;">&lt;-</span> plot_grid<span style="color: #3a81c3;">(</span>g1, g2<span style="color: #3a81c3;">)</span>

ggsave<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"beast-02.png"</span>,
       g,
       height = <span style="color: #4e3163;">10.5</span>,
       width = <span style="color: #4e3163;">14.8</span>,
       units = <span style="color: #2d9574;">"cm"</span><span style="color: #3a81c3;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alex Zarebski</p>
<p class="date">Created: 2021-11-09 Tue 18:40</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
